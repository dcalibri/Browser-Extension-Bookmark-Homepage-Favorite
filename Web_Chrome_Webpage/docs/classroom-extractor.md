# Google Classroom Attachment Extractor – Technical Specification

Main workflow: extract posts from Classroom → generate CSV → download attachments into post-named folders → mirror everything into a local directory.

---

## 1. Bookmarklet (JavaScript)

### 1.1 Target Surface
- Google Classroom → Classwork page (`https://classroom.google.com/c/*/m/*`)

### 1.2 Data Model
Each parsed post emits:
- `post_title`
- `post_date`
- `post_desc`
- `attachment_name`
- `attachment_link` (Drive URL converted to direct download)

### 1.3 Workflow Logic
1. Parse the DOM and locate all post containers.
2. Capture metadata fields above.
3. Convert Drive preview URLs (`.../view`) into direct download links (`.../uc?export=download&id=<fileId>`).
4. Download every attachment via `<a download>` or `fetch → blob → save`.
5. Generate a local folder per post: `YYMMDD - post_title/`.
6. Build a CSV with schema `post_title,post_date,post_desc,attachment_name,attachment_link`.
7. Optional sync mode skips files that already exist locally.

### 1.4 Attachment Coverage
Any Drive-backed asset (no API access required), including:
- PDFs
- Google Docs / Sheets / Slides (exported as `.docx`, `.xlsx`, `.pptx`)
- Images (`.jpg`, `.png`, etc.)
- Videos (`.mp4`)
- Arbitrary Drive-hosted files

### 1.5 Optional Enhancements
- Duplicate detection during sync
- ZIP packaging via JSZip

---

## 2. Python Automation (Optional)

### 2.1 Inputs
- CSV produced by the bookmarklet
- Folder hierarchy generated in step 1.3

### 2.2 Outputs
- Updated local CSV / spreadsheet (no Google API)
- Completed folder tree with missing files re-downloaded

*Note: Python also uses the direct download links emitted by the bookmarklet; no Google API calls are required.*

---

## 3. Output Structure

### 3.1 Directory Layout
```
/ClassroomExport/
    /<Class Name>/
        /241125 - Sistem Komputer/
            Bab_3.pdf
            Materi.docx
        /241128 - Jaringan/
            ...
```

### 3.2 CSV Sample
```
post_title,post_date,post_desc,attachment_name,attachment_link
Sistem Komputer,2024-11-25,"Materi Bab 3",Bab 3.pdf,https://drive.google.com/file/d/AAA/view
```

---

## 4. Tech Stack

### 4.1 Bookmarklet
- JavaScript (ES5)
- DOM traversal + sanitization
- Direct download (Blob) handling
- No external libraries required

### 4.2 Python (Optional)
- `pandas` for CSV handling
- `requests` for downloading via direct links
- Lightweight file-system utilities
- Zero Google API dependencies

---

## 5. Setup Instructions

### 5.1 Bookmarklet
1. Copy the minified JavaScript.
2. Create a new browser bookmark and paste the code into the URL field.
3. Open Google Classroom → Classwork.
4. Click the bookmark; extraction plus downloads start immediately.

### 5.2 Python Script
1. Install dependencies:
   ```bash
   pip install pandas requests
   ```
2. Place the CSV generated by the bookmarklet in the working directory.
3. Run:
   ```bash
   python sync.py
   ```

---

## 6. Deliverables
- Production bookmarklet (no Google API usage)
- CSV generator + Drive direct-download converter
- Optional Python sync script